\chapter{Introduction}
\label{ch:intro}

Patient motion is a critical cause of data loss in medical imaging. Many approaches have been developed to prevent and reduce the impact of motion before, during, and after image acquisition. The effectiveness of these techniques vary between patient populations. If the effects of a patient's movements cannot be removed from an image, that image is considered to have been corrupted by motion and is deemed unusable.

Though patient motion is a problem across the entire medical imaging domain, we focus specifically on resting state functional magnetic resonance imaging (rs-fMRI). rs-fMRIs measure the blood oxygen level dependent signal in an organ or organ system. Areas of an organ with greater activity require more oxygen than less active areas. When used to examine the brain, the signals recorded by the rs-fMRI are used as an effective approximation of the amount of activity occurring in different areas of the brain. The term ``resting state'' means that the patient is not performing any particular task, so any activity that occurs is from underlying networks connecting different areas of the brain. 

\section{Resting-state Functional Magnetic Resonance Images}

When an area of the brain is active, it uses more oxygen than the surrounding regions. Functional MRIs (fMRI) are sensitive to signals emitted by deoxygenated hemoglobin. The blood oxygen level dependent (BOLD) signal recorded by the fMRI reveal regions of the brain which are active at the same time. These combinations of regions are called neuronal networks. 

Many neuronal networks exist, but most of them are considered to be task related. In 2001, Raichle et al. suggested the existence of a neuronal network which operated when a person is at rest \cite{Raichle2001}. Their theory was confirmed by Greicius et al. in 2003 \cite{Greicius2003}. Because the patient is not performing a specific task when they are in a resting state, the resting-state networks have the potential to reveal valuable information about a patient's neurodevelopmental status.

To gather enough data to fully evaluate these networks, a series of image volumes must be acquired over a period of several minutes. A fMRI taken of a patient in a resting, task-free state, is called a resting-state fMRI (rs-fMRI). rs-fMRIs are sequences of image volumes acquired over a period of a few minutes. The image volumes themselves have relatively low spatial resolution when compared to structural MRIs, but their temporal resolution is significantly higher as a new volume is acquired every two to three seconds. 

The BOLD signals in rs-fMRI image sequences are analyzed using a process called functional connectivity analysis. Functional connectivity analysis identifies patterns and networks of brain activity. Some functional connectivity analysis studies have lead to the discoveries of links between specific disruptions in these naturally occurring networks and neurodevelopmental diseases such as autism and attention deficit hyperactivity disorder \cite{Assaf2010} \cite{Zang2007}. With further refinements of both acquisition techniques and characterization of these functional networks, clinicians may be able to use rs-fMRI to evaluate the neurodevelopmental status of CHD patients and to identify patients who may benefit from certain therapies or neuroprotective interventions.

To gather high quality data on such a short timescale, the rs-fMRI suffers from two major limitations: rs-fMR images have low physical resolution and are highly susceptible to motion. The first limitation can be addressed by obtaining an MR image with high physical resolution and registering the rs-fMRI to this structural image, but the second limitation is a significant problem. 

\section{Motion Effects, Prevention, and Correction}

There are three effects of motion on an rs-fMRI scan: the positional effect, the spin history effect, and the susceptibility effect. The impact of motion on the position of the patient means that a given voxel will not record electromagnetic signal from the same location in the brain for the duration of the scan. When the patient moves, the molecules which where in the area activated by the MRI scanner also move. Molecules which were not activated are now in the area where signal is being recorded, which results in a decrease in signal. At the next activation, an molecules which were moved out of the previous area of activation may be further activated, which can result in a increase in signal. These spin history effects impact the image sequence for several frames, but dissipate. The suspectibility effects impact the signal recorded by the scanner for the duration of the scan. The difference in the susceptibility of different tissues is most prominent at the tissue interfaces. When the patient moves, the tissue interfaces move and contribute or detract from the signal at new locations. 

In general, the best way to prevent the effects of motion is to prevent motion itself. Various clinical, behavioral, and technical protocols have been developed in an attempt to prevent patient motion from impacting the rs-fMR image as it is acquired. Sedation can be used to immobilize a patient during a scan, but requires additional personal to perform safely and involves a greater time commitment from the patient. Sedation is also not recommended for use in young children and fetal patients. Behavioral and educational techniques can be employed to prepare a patient for stressors he may experience during a medical imaging scan, but these approaches do not prevent the patient from moving out of boredom, discomfort, or distress. Several groups have developed techniques to compensate for motion as an image is acquired, but these techniques often require additional scanner-compatible equipment and can only be utilized during the scan. Sedation or intra-scan motion monitoring approaches are difficult to integrate with MR scanners due to the constraints of MR safety requirements. 

Additional processing is needed to remove motion from an image after the scan is acquired. Many methods have been developed to mitigate the effects of motion after the rs-fMRI is acquired. While different post-acquisition motion correction pipelines utilize different processing techniques, they begin with global volume registration. Global volume registration is the process used to align all volumes in a rs-fMRI sequence into the same physical space. Traditionally, all volumes in the sequence are registered directly to one volume. This approach can be effective in images where the subject remains relatively still throughout the duration of the scan, but is not as successful in images containing high quantities of patient movement.

We have developed an alternative volume registration framework which takes into account the spatiotemporal relationships between sequential volumes in the rs-fMRI sequence and uses these relationships during the registration process. Herein, we evaluate it further in the context of a complete motion correction pipeline across healthy and disease populations at various stages of life. In addition to reducing the effects of patient motion on image quality, we are also interested in the patient motion itself. We believe there are relationships between different motion patterns, patient age, and clinical outcomes, and we have explored these relationships throughout our experiments.

\section{Data}

The disease population we used for our study is a population with a variety of congenital heart defects. Congenital heart defects (CHDs) have many presentations, and all cause problems in a patient's heart structure and the structure of the surrounding vessels. It has been found that the development of cardiac problems \textit{in utero} is often linked to delays in patient neurodevelopment. Research in the area of CHD and neurodevelopment has often focused on younger populations. However, treatment of CHDs has evolved over the past fifty years with the result that many CHD patients live to adulthood: every year, approximately 1.35 million children are born with a congenital heart defect and it is currently estimated that about 12 to 34 million adults are living with CHD \cite{VanderLinde2011}. Researchers have recognized the burden of neurocognitive disorders on the aging CHD population and are now starting to investigate the relationships between CHD and neurocognitive outcomes.

The process for objectively identifying neurocognitive disorders is still under development. Psychologists have developed and validated surveys to estimate a patient's neurocognitive status. These surveys vary with the child's. Initially, a parent fills out the survey on behalf of his infant or toddler child. When the child has reached certain developmental milestones, the parent and child might both fill out different portions of a different survey. At some point, the child can fill out his own survey. Psychologists may meet with the patient and his parents to determine a diagnosis. These survey based methods are highly subjective, and objective methods based on rs-fMRIs are being explored. 

Eventually, clinicians will be able to develop a lifespan approach to managing CHD and neurocognitive disorders. As a community, we are still in the data-gathering stage of this research. We cannot afford to lose rs-fMRI scans of healthy or CHD patients in any stage of life because of motion. For these reasons, a cohort of healthy and CHD patient images are an ideal data set for our motion correction work. 

We were able to access data from three clinical cohorts. The first cohort is a set of healthy and CHD neonatal subjects scanned at our primary study site. The second cohort is a set of healthy and CHD preadolescent subjects enrolled in a multicenter study. Some subjects were scanned at our primary study site while others were scanned at one of the 11 other participating sites. The third cohort is a set of healthy and CHD fetal subjects scanned at our primary site.

Many rs-fMRI studies struggle to obtain enough low-motion scans to come to statistically significant conclusions. We develop a tool to address this challenge by simulating rs-fMRIs using existing average brain and functional region of interest templates. The simulated sequences contain brain signal, scanner noise, and motion. We then use this tool to simulate additional images with which to test the registration frameworks and to determine the effects of volume registration on brain signal.


%In addition to evaluating a global volume registration framework in the context of a fully motion correction pipeline, we also investigate the relationships between a patient's motion and their clinical outcomes, specifically to further the study of CHD and neurological disorders across the lifetime of the patient. %This analysis is valuable for each of our subject populations for different reasons. For the preadolescent patients, we are investigating the relationship between in-scan motion, neurocognitive development, and congenital heart disease status. In the fetal images, we investigate the relationship between FETAL BRAIN DEVELOPMENT AND PLACENTAL GROWTH. % need to run this part by Ashok.
%These investigations use both supervised and unsupervised machine learning techniques to determine what relationships a computer can detect between these pieces of information.

%For our study, we will use our large set of neurological rs-fMRIs of both healthy  and CHD neonatal, preadolescent, and adult subjects. We also have a set of neurological and placental rs-fMRIs for healthy and CHD fetal patients. We will apply both the tradition and novel registration frameworks to all images in our different cohorts and evaluate the impact of each framework on each image after passing it through a complete motion correction pipeline. The original, registered, and motion corrected images will be used to address the aims discussed in this chapter.

%Our aims for this project are as follows:
%\begin{itemize}
%\item \textbf{Aim 1.} Evaluate the impact of global volume registration on simulated and clinical data within a complete motion correction pipeline.
%\item \textbf{Aim 2.} Study the motion patterns in the different populations to formally describe demographic related motion patterns.
%\item \textbf{Aim 3.} Employ machine learning techniques to (a) measure the impact of motion on image harmonization in multi-center studies, and (b) evaluate the relationship between motion and cognitive, clinical, and behavioral outcomes of CHD patients.
%\end{itemize}

\section{Experiments}

Both the traditional and novel registration techniques are applied to the clinical and simulated images. We compare the original and registered images with respect to the amount of motion removed from each sequence. We use two metrics to measure the effects of motion and three metrics to measure the similarity of the images. 

The metrics used to measure motion are the change in patient position (framewise displacement, FD) and the change in overall signal (derivative fo the variance of the root mean square of the signal, DVARS) between one time point and the next. These metrics are only applied between every pair of chronological image volumes in a sequence. They are then compared to two thresholds commonly recognized in the field of motion in rs-fMRIs to determine the usability of an image sequence.

The three similarity metrics are the correlation ratio, the mutual information, and the Dice coefficient. The similarity metrics are used to compare every volume in a sequence to every other volume in the same sequence, which produces a two-dimensional matrix for each metric. Changes in the patterns of the matrices for the same metrics for the same images are used to determine the overall impact of registration on the similarities between volumes in an image sequence.

While correcting motion within an rs-fMRI is important both for clinical use and research applications, we are also interested in the motion itself. Through discussion with radiologists and researchers who work with rs-fMRIs, we have developed the following hypothesis: \textbf{Neonatal patients on average exhibit less motion than preadolescent patients, who exhibit less motion than fetal patients.} We evaluate this hypothesis using unsupervised machine learning techniques to identify clusters of similar patients. The unsupervised machine learning techniques will also be applied to age group level cohorts to identify patients with common patterns of motion in each cohort.

\section{Summary}


The remainder of this document is laid out as follows. We elaborate on resting-state functional magnetic resonance images (rs-fMRIs) and their use for investigating functional brain networks in Chapter \ref{ch:mri}. In Chapter \ref{ch:moco}, we perform a breadth-wise review of the effects of motion, methods to prevent motion, and methods to mitigate the effects of motion.
Chapter \ref{ch:mopa} transitions into methods for analyzing MRIs, machine learning techniques, and our approach to statistical analysis. 

Chapter \ref{ch:data} discusses congenital heart disease, its relationship with neurological conditions, and methods for evaluating neurological conditions. It also contains information about the scans and demographics information for each clinical cohort as well as details about the simulation. 

Chapter \ref{ch:results} contains the results of our experiments and statistical analyses for the registration experiments and the machine learning experiments. Chapter \ref{ch:discussion} contains a discussion of these results, and Chapter \ref{ch:fin} contains a metadiscussion of this study as a whole.